<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
  <h1>ğŸ“ Capstone Project Generator</h1>
  <p>Enter your full learning path below to generate a custom capstone project idea:</p>
  <textarea id="learningPath" rows="10" placeholder="e.g. Python â†’ Web Dev â†’ APIs â†’ Databases â†’ Deployment..."></textarea>
  <br>
  <button onclick="generateCapstone()">ğŸš€ Generate</button>

  <div id="output">Output will appear here...</div>
  <div id="status"></div>

  <script>
    async function generateCapstone() {
      const outputDiv = document.getElementById("output");
      const statusDiv = document.getElementById("status");
      const learningPath = document.getElementById("learningPath").value.trim();

      if (!learningPath) {
        outputDiv.innerText = "âš ï¸ Please enter a learning path.";
        return;
      }

      outputDiv.innerText = "â³ Generating capstone project...\n";
      statusDiv.innerText = "ğŸ”Œ Connecting to backend...";

      try {
        const response = await fetch("http://127.0.0.1:8080/generate_project", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ learning_path: learningPath })
        });

        if (!response.ok) {
          const err = await response.text();
          outputDiv.innerText = `âŒ Server Error: ${err}`;
          statusDiv.innerText = "âŒ Connection failed.";
          return;
        }

        statusDiv.innerText = "âœ… Connected successfully!";
        const projectData = await response.json();

        // Format the JSON response into readable text
        let outputText = `ğŸ“ ${projectData.title}\n\n`;
        outputText += `ğŸ“– Description: ${projectData.description}\n\n`;
        outputText += `ğŸ›  Technologies: ${projectData.technologies.join(', ')}\n\n`;
        outputText += `ğŸ¯ Expected Outcomes:\n- ${projectData.expected_outcomes.join('\n- ')}\n\n`;
        outputText += `ğŸ“¦ Deliverables:\n- ${projectData.deliverables.join('\n- ')}\n\n`;
        
        projectData.phases.forEach((phase, index) => {
          outputText += `\nğŸ”° Phase ${index + 1}: ${phase.name} (${phase.duration})\n`;
          phase.modules.forEach(module => {
            outputText += `   â”œâ”€ ${module.name}\n`;
            outputText += `   â”‚  â†’ Type: ${module.content_type}\n`;
            outputText += `   â”‚  â†’ Duration: ${module.content_duration}\n`;
            outputText += `   â”‚  â†’ ${module.description}\n`;
          });
        });

        outputDiv.innerText = outputText;

      } catch (err) {
        outputDiv.innerText = "âŒ Failed to connect to backend: " + err;
        statusDiv.innerText = "âŒ Connection failed.";
      }
    }
  </script>
</body>
</html>
